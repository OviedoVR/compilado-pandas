<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vin√≠cius Oviedo">

<title>üñ•Ô∏è Compilado de Pandas - Manipula√ß√£o de Dados com Pandas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/quarto-contrib/bookup_fonts_gwf-0.0/fonts-embed.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">üñ•Ô∏è Compilado de Pandas</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">In√≠cio</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-aulas" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Aulas</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-aulas">    
        <li>
    <a class="dropdown-item" href="../sections/leitura_arquivos.html">
 <span class="dropdown-text">1. Leitura de arquivos</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../sections/metodos_basicos_pandas.html">
 <span class="dropdown-text">2. M√©todos b√°sicos</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../sections/slicing_e_filtros.html">
 <span class="dropdown-text">3. Slicing e filtros</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../sections/estatistica_com_pandas.html">
 <span class="dropdown-text">4. M√©todos estat√≠sticos</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../sections/agregacoes.html">
 <span class="dropdown-text">5. Agrega√ß√µes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../sections/juncoes.html">
 <span class="dropdown-text">6. Jun√ß√µes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../sections/limpeza_de_dados.html">
 <span class="dropdown-text">7. Limpeza de dados</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../sections/visualizacao.html">
 <span class="dropdown-text">8. Visualiza√ß√£o de dados</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#agrega√ß√µes" id="toc-agrega√ß√µes" class="nav-link active" data-scroll-target="#agrega√ß√µes">Agrega√ß√µes</a>
  <ul class="collapse">
  <li><a href="#m√©todo-groupby" id="toc-m√©todo-groupby" class="nav-link" data-scroll-target="#m√©todo-groupby">1. M√©todo <code>groupby()</code></a></li>
  <li><a href="#m√©todo-agg" id="toc-m√©todo-agg" class="nav-link" data-scroll-target="#m√©todo-agg">2. M√©todo <code>agg</code></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Manipula√ß√£o de Dados com Pandas</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Vin√≠cius Oviedo </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="agrega√ß√µes" class="level1">
<h1>Agrega√ß√µes</h1>
<p>Nesta aula, vamos trabalhar com agrega√ß√£o de dados com <code>Pandas</code>. √â uma aula mais curta, comparada √†s anteriores, por√©m permite um leque de possibilidades. Veremos:</p>
<ol type="1">
<li>M√©todo <code>groupby</code></li>
<li>M√©todo <code>agg</code></li>
</ol>
<p>Para isso, utilizaremos o conjunto de dados sobre <strong>vendas</strong>.</p>
<div id="57f775ef" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>vendas_europa <span class="op">=</span> pd.read_csv(<span class="st">'dados/vendas/EuropeSalesRecords.csv'</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>vendas_europa.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Region</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Item Type</th>
<th data-quarto-table-cell-role="th">Sales Channel</th>
<th data-quarto-table-cell-role="th">Order Priority</th>
<th data-quarto-table-cell-role="th">Order Date</th>
<th data-quarto-table-cell-role="th">Order ID</th>
<th data-quarto-table-cell-role="th">Ship Date</th>
<th data-quarto-table-cell-role="th">Units Sold</th>
<th data-quarto-table-cell-role="th">Unit Price</th>
<th data-quarto-table-cell-role="th">Unit Cost</th>
<th data-quarto-table-cell-role="th">Total Revenue</th>
<th data-quarto-table-cell-role="th">Total Cost</th>
<th data-quarto-table-cell-role="th">Total Profit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Europe</td>
<td>Czech Republic</td>
<td>Beverages</td>
<td>Offline</td>
<td>C</td>
<td>9/12/2011</td>
<td>478051030</td>
<td>9/29/2011</td>
<td>4778</td>
<td>47.45</td>
<td>31.79</td>
<td>226716.10</td>
<td>151892.62</td>
<td>74823.48</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Europe</td>
<td>Bosnia and Herzegovina</td>
<td>Clothes</td>
<td>Online</td>
<td>M</td>
<td>10/14/2013</td>
<td>919133651</td>
<td>11/4/2013</td>
<td>927</td>
<td>109.28</td>
<td>35.84</td>
<td>101302.56</td>
<td>33223.68</td>
<td>68078.88</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Europe</td>
<td>Austria</td>
<td>Cereal</td>
<td>Offline</td>
<td>C</td>
<td>8/13/2014</td>
<td>987410676</td>
<td>9/6/2014</td>
<td>5616</td>
<td>205.70</td>
<td>117.11</td>
<td>1155211.20</td>
<td>657689.76</td>
<td>497521.44</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Europe</td>
<td>Bulgaria</td>
<td>Office Supplies</td>
<td>Online</td>
<td>L</td>
<td>10/31/2010</td>
<td>672330081</td>
<td>11/29/2010</td>
<td>6266</td>
<td>651.21</td>
<td>524.96</td>
<td>4080481.86</td>
<td>3289399.36</td>
<td>791082.50</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Europe</td>
<td>Estonia</td>
<td>Fruits</td>
<td>Online</td>
<td>L</td>
<td>9/28/2016</td>
<td>579463422</td>
<td>11/1/2016</td>
<td>4958</td>
<td>9.33</td>
<td>6.92</td>
<td>46258.14</td>
<td>34309.36</td>
<td>11948.78</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="m√©todo-groupby" class="level2">
<h2 class="anchored" data-anchor-id="m√©todo-groupby">1. M√©todo <code>groupby()</code></h2>
<p>Nesse m√©todo, podemos agrupar dados com base em categorias e precisamos obrigatoriamente informar uma medida de agrega√ß√£o (e.g, soma, m√©dia, mediana, desvio padr√£o, etc.). Come√ßemos com uma pergunta de neg√≥cio.</p>
<blockquote class="blockquote">
<p><strong>Qual foi o faturamento total por pa√≠s? (usemos 1 casas decimal)</strong></p>
</blockquote>
<div id="07ce4e16" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>vendas_europa.groupby(<span class="st">'Country'</span>)[<span class="st">'Total Revenue'</span>].<span class="bu">sum</span>().<span class="bu">round</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>Country
Albania                   32224853.9
Andorra                   47756693.2
Armenia                   37519840.2
Austria                   35740871.5
Belarus                   34236260.8
Belgium                   25852572.3
Bosnia and Herzegovina    50117508.5
Bulgaria                  38161555.7
Croatia                   27348195.7
Cyprus                    33008851.5
Czech Republic            53543932.1
Denmark                   26968532.5
Estonia                   23410001.8
Finland                   26027949.0
France                    39362112.2
Georgia                   22802195.7
Germany                   38055087.6
Greece                    38699541.7
Hungary                   42408249.1
Iceland                   25570227.4
Ireland                   33022223.3
Italy                     35878352.1
Kosovo                    53833142.8
Latvia                    38722084.2
Liechtenstein             29872564.4
Lithuania                 29031942.1
Luxembourg                33075377.2
Macedonia                 49222085.2
Malta                     47145320.8
Moldova                   27031700.1
Monaco                    13828738.2
Montenegro                31346476.9
Netherlands               20860788.8
Norway                    31520698.5
Poland                    33805403.2
Portugal                  47172189.8
Romania                   34286150.8
Russia                    46051659.8
San Marino                47883708.5
Serbia                    42193537.7
Slovakia                  42940998.3
Slovenia                  38892531.3
Spain                     27644278.7
Sweden                    35482128.0
Switzerland               31875174.0
Ukraine                   53252317.5
United Kingdom            26654989.5
Vatican City              22280804.1
Name: Total Revenue, dtype: float64</code></pre>
</div>
</div>
<p>Note que country veio como in√≠dice, mas podemos deixar as categorias como linhas convencionais (usando <code>as_index=False</code>) e adicionar mais de uma categoria. Para isso, vamos responder a outra pergunta.</p>
<blockquote class="blockquote">
<p><strong>Qual foi o lucro m√©dio em cada pa√≠s por canal de venda? listemos o top 5</strong></p>
</blockquote>
<div id="acd067d8" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrega√ß√£o:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>lucro_medio_pais_e_canal <span class="op">=</span> vendas_europa.groupby(<span class="st">'Country'</span>, as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">'Total Profit'</span>].<span class="bu">sum</span>().<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordena√ß√£o dos dados:</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>lucro_medio_pais_e_canal <span class="op">=</span> lucro_medio_pais_e_canal.sort_values(</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  by<span class="op">=</span><span class="st">'Total Profit'</span>, ascending<span class="op">=</span><span class="va">False</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiza√ß√£o dos resultados:</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>lucro_medio_pais_e_canal.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Total Profit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>Andorra</td>
<td>15410036.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">45</td>
<td>Ukraine</td>
<td>14804925.7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>Malta</td>
<td>14610127.9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>Kosovo</td>
<td>14409145.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>San Marino</td>
<td>13792992.8</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="m√©todo-agg" class="level2">
<h2 class="anchored" data-anchor-id="m√©todo-agg">2. M√©todo <code>agg</code></h2>
<p>Esse metodo serve para utilizarmos mais de uma medida de agrega√ß√£o. No caso da pergunta anterior, s√≥ a m√©dia n√£o nos diz muita coisa. Em outras palavras, √© uma boa pr√°tica mostrar o desvio padr√£o junto √† m√©dia. Assim, temos uma no√ß√£o da variabilidade dos dados e se a m√©dia de fato representa bem nosso conjunto de dados. Vamos utilizar a mesma l√≥gica da pergunta anterior, mas mostrando os 5 piores em termos de lucro.</p>
<div id="4daec241" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrega√ß√£o:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>vendas_europa.groupby([<span class="st">'Country'</span>, <span class="st">'Sales Channel'</span>])[<span class="st">'Total Profit'</span>]<span class="op">\</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  .agg([<span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'median'</span>]).tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">median</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Sales Channel</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Ukraine</td>
<td data-quarto-table-cell-role="th">Online</td>
<td>540192.216250</td>
<td>461192.942092</td>
<td>419867.210</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">United Kingdom</td>
<td data-quarto-table-cell-role="th">Offline</td>
<td>386919.697143</td>
<td>400336.448858</td>
<td>250574.940</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Online</td>
<td>413617.145625</td>
<td>457835.010825</td>
<td>216474.465</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Vatican City</td>
<td data-quarto-table-cell-role="th">Offline</td>
<td>262827.323125</td>
<td>298981.868340</td>
<td>115792.650</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Online</td>
<td>315512.177143</td>
<td>197270.837319</td>
<td>272952.500</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Outra op√ß√£o √©:</p>
<div id="c31a1c1c" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrega√ß√£o:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>vendas_europa.groupby([<span class="st">'Country'</span>, <span class="st">'Sales Channel'</span>])[<span class="st">'Total Profit'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Sales Channel</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Albania</td>
<td data-quarto-table-cell-role="th">Offline</td>
<td>11.0</td>
<td>614448.018182</td>
<td>612231.249278</td>
<td>35454.24</td>
<td>79415.0400</td>
<td>543430.340</td>
<td>890054.8050</td>
<td>1672455.53</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Online</td>
<td>10.0</td>
<td>373177.782000</td>
<td>399647.088296</td>
<td>17601.84</td>
<td>63175.9350</td>
<td>229644.635</td>
<td>625957.5150</td>
<td>1107843.75</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Andorra</td>
<td data-quarto-table-cell-role="th">Offline</td>
<td>18.0</td>
<td>249127.326111</td>
<td>315220.845804</td>
<td>2369.03</td>
<td>25045.9475</td>
<td>126314.510</td>
<td>413880.4275</td>
<td>1245958.14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Online</td>
<td>22.0</td>
<td>496624.761818</td>
<td>497687.329727</td>
<td>24194.70</td>
<td>108122.5350</td>
<td>347167.260</td>
<td>712274.5800</td>
<td>1700448.60</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Armenia</td>
<td data-quarto-table-cell-role="th">Offline</td>
<td>16.0</td>
<td>385731.609375</td>
<td>347925.918412</td>
<td>8492.84</td>
<td>91203.5000</td>
<td>402212.320</td>
<td>499465.2850</td>
<td>1236511.53</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Ukraine</td>
<td data-quarto-table-cell-role="th">Online</td>
<td>16.0</td>
<td>540192.216250</td>
<td>461192.942092</td>
<td>28141.02</td>
<td>172150.1700</td>
<td>419867.210</td>
<td>767868.0850</td>
<td>1574045.11</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">United Kingdom</td>
<td data-quarto-table-cell-role="th">Offline</td>
<td>7.0</td>
<td>386919.697143</td>
<td>400336.448858</td>
<td>17568.90</td>
<td>131640.1800</td>
<td>250574.940</td>
<td>491785.0000</td>
<td>1193443.68</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Online</td>
<td>16.0</td>
<td>413617.145625</td>
<td>457835.010825</td>
<td>9033.12</td>
<td>77568.1000</td>
<td>216474.465</td>
<td>598346.2875</td>
<td>1531273.09</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Vatican City</td>
<td data-quarto-table-cell-role="th">Offline</td>
<td>16.0</td>
<td>262827.323125</td>
<td>298981.868340</td>
<td>16419.33</td>
<td>44425.1150</td>
<td>115792.650</td>
<td>385834.8300</td>
<td>1016587.82</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Online</td>
<td>7.0</td>
<td>315512.177143</td>
<td>197270.837319</td>
<td>52429.68</td>
<td>196048.0750</td>
<td>272952.500</td>
<td>449443.3750</td>
<td>592220.16</td>
</tr>
</tbody>
</table>

<p>96 rows √ó 8 columns</p>
</div>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb7" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Manipula√ß√£o de Dados com Pandas"</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Vin√≠cius Oviedo"</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">  bookup-html+darkonly:</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">    embed-fonts: true</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu"># Agrega√ß√µes</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>Nesta aula, vamos trabalhar com agrega√ß√£o de dados com <span class="in">`Pandas`</span>. √â uma aula mais curta, comparada √†s anteriores, por√©m permite um leque de possibilidades. Veremos:</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>M√©todo <span class="in">`groupby`</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>M√©todo <span class="in">`agg`</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>Para isso, utilizaremos o conjunto de dados sobre **vendas**.</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>vendas_europa <span class="op">=</span> pd.read_csv(<span class="st">'dados/vendas/EuropeSalesRecords.csv'</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>vendas_europa.head()</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1. M√©todo `groupby()`</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>Nesse m√©todo, podemos agrupar dados com base em categorias e precisamos obrigatoriamente informar uma medida de agrega√ß√£o (e.g, soma, m√©dia, mediana, desvio padr√£o, etc.). Come√ßemos com uma pergunta de neg√≥cio.</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **Qual foi o faturamento total por pa√≠s? (usemos 1 casas decimal)**</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>vendas_europa.groupby(<span class="st">'Country'</span>)[<span class="st">'Total Revenue'</span>].<span class="bu">sum</span>().<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>Note que country veio como in√≠dice, mas podemos deixar as categorias como linhas convencionais (usando <span class="in">`as_index=False`</span>) e adicionar mais de uma categoria. Para isso, vamos responder a outra pergunta.</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **Qual foi o lucro m√©dio em cada pa√≠s por canal de venda? listemos o top 5**</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrega√ß√£o:</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>lucro_medio_pais_e_canal <span class="op">=</span> vendas_europa.groupby(<span class="st">'Country'</span>, as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">'Total Profit'</span>].<span class="bu">sum</span>().<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordena√ß√£o dos dados:</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>lucro_medio_pais_e_canal <span class="op">=</span> lucro_medio_pais_e_canal.sort_values(</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>  by<span class="op">=</span><span class="st">'Total Profit'</span>, ascending<span class="op">=</span><span class="va">False</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiza√ß√£o dos resultados:</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>lucro_medio_pais_e_canal.head()</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. M√©todo `agg`</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>Esse metodo serve para utilizarmos mais de uma medida de agrega√ß√£o. No caso da pergunta anterior, s√≥ a m√©dia n√£o nos diz muita coisa. Em outras palavras, √© uma boa pr√°tica mostrar o desvio padr√£o junto √† m√©dia. Assim, temos uma no√ß√£o da variabilidade dos dados e se a m√©dia de fato representa bem nosso conjunto de dados. Vamos utilizar a mesma l√≥gica da pergunta anterior, mas mostrando os 5 piores em termos de lucro.</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrega√ß√£o:</span></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>vendas_europa.groupby([<span class="st">'Country'</span>, <span class="st">'Sales Channel'</span>])[<span class="st">'Total Profit'</span>]<span class="op">\</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>  .agg([<span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'median'</span>]).tail()</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>Outra op√ß√£o √©:</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrega√ß√£o:</span></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>vendas_europa.groupby([<span class="st">'Country'</span>, <span class="st">'Sales Channel'</span>])[<span class="st">'Total Profit'</span>].describe()</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>